<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Multi Intersection Traffic Light Simulator</title>
<style>
  body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: radial-gradient(circle at top, #0b1220, #050b13);
    color: #e8eef8;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: start;
    min-height: 100vh;
    padding-top: 20px;
  }

  h2 { margin-bottom: 10px; }

  .row {
    display: flex;
    gap: 50px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .traffic {
    background: #111922;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
  }

  .lamp {
    width: 90px;
    height: 90px;
    margin: 12px 0;
    border-radius: 50%;
    background: rgba(255,255,255,0.08);
    box-shadow: inset 0 0 15px rgba(0,0,0,0.6);
    transition: background 0.3s, box-shadow 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .lamp.on.red { background: red; box-shadow: 0 0 30px red; }
  .lamp.on.yellow { background: yellow; box-shadow: 0 0 30px yellow; }
  .lamp.on.green { background: #00ff66; box-shadow: 0 0 30px #00ff66; }

  .lamp span {
    font-weight: bold;
    font-size: 1.5em;
    color: #000;
    text-shadow: 0 0 4px rgba(255,255,255,0.6);
  }

  .progress {
    position: absolute;
    bottom: 8px;
    left: 10%;
    height: 6px;
    width: 80%;
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
    overflow: hidden;
  }

  .progress .bar {
    height: 100%;
    background: #00bcd4;
    width: 0%;
    transition: width 1s linear;
  }

  .controls {
    margin-top: 25px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
  }

  button {
    padding: 10px 14px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-weight: bold;
    color: #fff;
    background: #0ea5a4;
  }

  button.stop { background: #ff4757; }
  button.secondary { background: #1e293b; }
  button.warning { background: #facc15; color:#111; }

  .settings {
    margin-top: 15px;
    text-align: center;
  }

  input {
    width: 50px;
    text-align: center;
    padding: 4px;
    border-radius: 5px;
    border: 1px solid #334155;
    background: #0f172a;
    color: #e2e8f0;
  }

  .pedestrian {
    margin-top: 12px;
    text-align: center;
    font-size: 1em;
  }

  .walk { color: #00ff66; }
  .dont { color: #ff3b3b; }
</style>
</head>
<body>

<h2>üö¶ Multi Intersection Traffic Light Simulator</h2>

<div class="row">
  <div class="traffic" id="mainIntersection">
    <h3>Main Road</h3>
    <div class="lamp red" id="mainRed"><span></span><div class="progress"><div class="bar" id="barMainRed"></div></div></div>
    <div class="lamp yellow" id="mainYellow"><span></span><div class="progress"><div class="bar" id="barMainYellow"></div></div></div>
    <div class="lamp green" id="mainGreen"><span></span><div class="progress"><div class="bar" id="barMainGreen"></div></div></div>
    <div class="pedestrian" id="pedMain">üö∂‚Äç‚ôÇÔ∏è <span class="dont">DON‚ÄôT WALK</span></div>
  </div>

  <div class="traffic" id="crossIntersection">
    <h3>Cross Road</h3>
    <div class="lamp red" id="crossRed"><span></span><div class="progress"><div class="bar" id="barCrossRed"></div></div></div>
    <div class="lamp yellow" id="crossYellow"><span></span><div class="progress"><div class="bar" id="barCrossYellow"></div></div></div>
    <div class="lamp green" id="crossGreen"><span></span><div class="progress"><div class="bar" id="barCrossGreen"></div></div></div>
    <div class="pedestrian" id="pedCross">üö∂‚Äç‚ôÇÔ∏è <span class="dont">DON‚ÄôT WALK</span></div>
  </div>
</div>

<div class="controls">
  <button id="start">Start</button>
  <button class="stop" id="stop">Stop</button>
  <button class="secondary" id="pause">Pause</button>
  <button class="secondary" id="resume">Resume</button>
  <button class="warning" id="blink">Blink Mode</button>
  <button id="emergency">Emergency</button>
  <button id="walkBtn">Pedestrian Request</button>
</div>

<div class="settings">
  ‚è± Red: <input type="number" id="redTime" value="6">s |
  Yellow: <input type="number" id="yellowTime" value="2">s |
  Green: <input type="number" id="greenTime" value="6">s
</div>

<script>
let durations = { green: 6, yellow: 2, red: 6 };
let mainLights = ['green', 'yellow', 'red'];
let crossLights = ['red', 'yellow', 'green'];
let current = 0;
let interval, timeout;
let paused = false, blinking = false, emergency = false;
let remaining = durations.green;

const lampElems = {
  main: {
    red: document.getElementById('mainRed'),
    yellow: document.getElementById('mainYellow'),
    green: document.getElementById('mainGreen')
  },
  cross: {
    red: document.getElementById('crossRed'),
    yellow: document.getElementById('crossYellow'),
    green: document.getElementById('crossGreen')
  }
};
const progressBars = {
  main: {
    red: document.getElementById('barMainRed'),
    yellow: document.getElementById('barMainYellow'),
    green: document.getElementById('barMainGreen')
  },
  cross: {
    red: document.getElementById('barCrossRed'),
    yellow: document.getElementById('barCrossYellow'),
    green: document.getElementById('barCrossGreen')
  }
};
const spans = {
  main: {
    red: lampElems.main.red.querySelector('span'),
    yellow: lampElems.main.yellow.querySelector('span'),
    green: lampElems.main.green.querySelector('span')
  },
  cross: {
    red: lampElems.cross.red.querySelector('span'),
    yellow: lampElems.cross.yellow.querySelector('span'),
    green: lampElems.cross.green.querySelector('span')
  }
};
const pedestrian = {
  main: document.getElementById('pedMain'),
  cross: document.getElementById('pedCross')
};

function updateDurations(){
  durations.red = parseInt(document.getElementById('redTime').value)||6;
  durations.yellow = parseInt(document.getElementById('yellowTime').value)||2;
  durations.green = parseInt(document.getElementById('greenTime').value)||6;
}

function setLight(intersection, color){
  Object.keys(lampElems[intersection]).forEach(c=>{
    lampElems[intersection][c].classList.remove('on', c);
    spans[intersection][c].textContent = '';
    progressBars[intersection][c].style.width = '0%';
  });
  if(color){
    lampElems[intersection][color].classList.add('on', color);
  }
}

function startCycle(){
  if (paused || blinking || emergency) return;
  clearInterval(interval);
  clearTimeout(timeout);
  updateDurations();

  const mainColor = mainLights[current];
  const crossColor = crossLights[current];

  // set active colors
  setLight('main', mainColor);
  setLight('cross', crossColor);

  remaining = durations[mainColor];
  spans.main[mainColor].textContent = remaining;
  spans.cross[crossColor].textContent = remaining;
  progressBars.main[mainColor].style.width = '100%';
  progressBars.cross[crossColor].style.width = '100%';

  // Pedestrian logic
  pedestrian.main.innerHTML = mainColor === 'red'
    ? 'üö∂‚Äç‚ôÇÔ∏è <span class="walk">WALK</span>'
    : 'üö∂‚Äç‚ôÇÔ∏è <span class="dont">DON‚ÄôT WALK</span>';
  pedestrian.cross.innerHTML = crossColor === 'red'
    ? 'üö∂‚Äç‚ôÇÔ∏è <span class="walk">WALK</span>'
    : 'üö∂‚Äç‚ôÇÔ∏è <span class="dont">DON‚ÄôT WALK</span>';

  interval = setInterval(()=>{
    if(paused) return;
    remaining--;
    spans.main[mainColor].textContent = remaining;
    spans.cross[crossColor].textContent = remaining;
    progressBars.main[mainColor].style.width = `${(remaining / durations[mainColor]) * 100}%`;
    progressBars.cross[crossColor].style.width = `${(remaining / durations[crossColor]) * 100}%`;
  },1000);

  timeout = setTimeout(()=>{
    clearInterval(interval);
    current = (current + 1) % mainLights.length;
    startCycle();
  }, durations[mainColor]*1000);
}

function stopCycle(){
  clearInterval(interval);
  clearTimeout(timeout);
  ['main','cross'].forEach(int=>{
    setLight(int, null);
    pedestrian[int].innerHTML = 'üö∂‚Äç‚ôÇÔ∏è <span class="dont">DON‚ÄôT WALK</span>';
  });
}

document.getElementById('start').onclick = ()=>{
  blinking = false;
  emergency = false;
  paused = false;
  startCycle();
};
document.getElementById('stop').onclick = stopCycle;
document.getElementById('pause').onclick = ()=>paused=true;
document.getElementById('resume').onclick = ()=>paused=false;
document.getElementById('blink').onclick = ()=>{
  stopCycle();
  blinking = true;
  let on = false;
  const yellowMain = lampElems.main.yellow;
  const yellowCross = lampElems.cross.yellow;
  setInterval(()=>{
    if(!blinking) return;
    on = !on;
    yellowMain.classList.toggle('on', on);
    yellowCross.classList.toggle('on', on);
  },500);
};
document.getElementById('emergency').onclick = ()=>{
  stopCycle();
  emergency = true;
  setLight('main','green');
  setLight('cross','red');
  spans.main.green.textContent = 'EMERGENCY';
  pedestrian.main.innerHTML = 'üöí Emergency Mode ‚Äî Main Road Clear!';
};
document.getElementById('walkBtn').onclick = ()=>{
  if(mainLights[current] !== 'red'){
    current = 2; // jump to red
    startCycle();
  }
};
</script>
</body>
</html>
