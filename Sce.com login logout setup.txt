üîê Authentication Flow Using Okta Sign-In Widget

We integrated the Okta Sign-In Widget (installed via npm) to handle authentication and MFA flows in the React application.

1Ô∏è‚É£ Widget Initialization

When the user clicks Login:

We initialize the Okta Sign-In Widget

Pass configuration (clientId, issuer, redirectUri, scopes)

Provide a container ID

The widget renders inside that container

Okta handles:

Username/password authentication

MFA enrollment

OTP validation (email/SMS)

2Ô∏è‚É£ User Authentication

User enters credentials

If MFA is enrolled ‚Üí user selects email/SMS

OTP is validated by Okta

If MFA not enrolled ‚Üí direct authentication

All authentication logic is handled by Okta ‚Äî not by our UI.

3Ô∏è‚É£ Session & Token Creation

After successful authentication:

Okta establishes a session (typically 15 mins)

UI receives:

Access Token

Refresh Token

ID Token (if needed)

Okta also sets an idx session cookie.

If the user is active:

UI refreshes the session every 10 minutes to avoid expiry.

4Ô∏è‚É£ Token Flow to Backend (Microservice)

UI sends Access Token to MS in Authorization header.

MS validates Access Token with Okta (via public keys / introspection).

If valid:

MS sets its own secure session cookies for subsequent requests.

Every API request:

MS validates the token or session.

5Ô∏è‚É£ Token Expiry Handling

If Access Token expires:

MS uses Refresh Token to request new Access Token from Okta.

Okta validates refresh token.

New Access Token is issued.

MS continues serving secure APIs.

This ensures seamless session continuation.

6Ô∏è‚É£ Logout Flow

When user logs out:

UI sends logout request to Okta

Okta terminates session using idx cookie

UI also calls MS logout endpoint

MS clears its own session cookies

This ensures:

Okta session is destroyed

Backend session is destroyed

No secure calls are allowed afterward

üî• Important Edge Case (Interview Bonus)

If:

Okta session is terminated

But MS session is not cleared

Then:

If MS relies only on its own cookies, secure calls may still work.

Proper implementation must ensure:

MS validates token expiry

MS session is also invalidated on logout

This avoids session mismatch.

üé§ Short 30-Second Version (If Interviewer Is Senior)

We used Okta Sign-In Widget via npm for authentication and MFA. After successful login, Okta issues access and refresh tokens. The UI sends the access token to the backend for validation. The backend validates tokens with Okta and manages session cookies. If the access token expires, it uses the refresh token to obtain a new one. On logout, both Okta session and backend session are terminated to prevent unauthorized access.

---------------------------------------------------------------------------------

Ul Integerates okta sign in widget (using cdn, it can be added using as npm package, in interview for simplicity tell them we used npm package to avoid extra question on why cdn over npm)

okta sign widget comes with implemented authentication methods (like mfa with support for email/phone authentication)

1. sign in widget is initiliazed on dick of login. (okta package provides one function that takes config and ui element id, it renders widget in that container with given id).

2. user enters credentials

3. if MFA is enrolled, widget asks preference to get otp via email or phone, it validates otp, if mfa is not enrolled, it directly authenticates.

4. Post authentication is successful, its sets idx(session is setup at okta 15mins and Ul refreshes at interval of 10mins if user

is active) cookie at Ul and sends refresh and access token.

5. refresh and access token are send to MS. MS validates with okta

6. After validation ms sets cookies in Ul, these are validated for every requests

7. MS validates access token, if access token is expired, ms request for new access token in exchange of refresh token from okta.

8. Logout:- Ul sends logout request to okta to terminate the session at okta. Okta uses stored idx cookie to terminate session, after this UI Sends logout request to MS also, to logout dms session.